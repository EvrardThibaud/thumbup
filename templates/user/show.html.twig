{% extends 'base.html.twig' %}
{% block title %}User #{{ user.id }}{% endblock %}

{% block body %}
{% set tz = app.user ? app.user.timezone : 'Europe/Paris' %}

<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h4 m-0">
      ğŸ‘¤ User <span class="text-secondary">#{{ user.id }}</span>
    </h1>
    <div class="d-flex gap-2">
      <a class="btn btn-sm btn-outline-light rounded-1"
         href="{{ path('app_user_index') }}">
        â† Back
      </a>
      <a class="btn btn-sm btn-outline-light rounded-1"
         href="{{ path('app_user_edit', {id: user.id, back: app.request.uri}) }}">
        âœï¸ Edit
      </a>
      <form method="post"
            action="{{ path('app_user_delete', {id: user.id}) }}"
            class="d-inline"
            onsubmit="return confirm('Delete this user?');">
        <input type="hidden" name="_token" value="{{ csrf_token('delete-user' ~ user.id) }}">
        <button class="btn btn-sm btn-outline-danger rounded-1">
          ğŸ—‘ Delete
        </button>
      </form>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-12 col-lg-6">
      <div class="card bg-dark border-secondary rounded-2 h-100">
        <div class="card-header border-secondary">
          <span class="fw-semibold">Profile</span>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-4 text-secondary">Email</dt>
            <dd class="col-sm-8">{{ user.email }}</dd>

            <dt class="col-sm-4 text-secondary">Roles</dt>
            <dd class="col-sm-8">
              {% for r in user.roles %}
                <span class="badge text-bg-{{ r == 'ROLE_ADMIN' ? 'primary' : (r == 'ROLE_CLIENT' ? 'success' : 'secondary') }} rounded-1 me-1">
                  {{ r }}
                </span>
              {% else %}
                <span class="text-secondary">â€”</span>
              {% endfor %}
            </dd>

            <dt class="col-sm-4 text-secondary">Time zone</dt>
            <dd class="col-sm-8">
              {{ user.timezone ?? 'Europe/Paris' }}
            </dd>

              <dt class="col-sm-4 text-secondary">Client</dt>
              <dd class="col-sm-8">
              {% if user.client %}
                  <a class="link-light link-opacity-75-hover"
                    href="{{ path('app_client_show', { id: user.client.id }) }}">
                    {{ user.client.name }}
                  </a>
              {% endif %}
              â€”
              </dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-12 col-lg-6">
      <div class="card bg-dark border-secondary rounded-2 h-100">
        <div class="card-header border-secondary">
          <span class="fw-semibold">Account status</span>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-4 text-secondary">User ID</dt>
            <dd class="col-sm-8">#{{ user.id }}</dd>

            <dt class="col-sm-4 text-secondary">Email verified</dt>
            <dd class="col-sm-8">
              {% if user.isVerified %}
                <span class="badge text-bg-success rounded-1">Yes</span>
              {% else %}
                <span class="badge text-bg-secondary rounded-1">No</span>
              {% endif %}
            </dd>

            <dt class="col-sm-4 text-secondary">Created</dt>
            <dd class="col-sm-8 text-secondary">
              {{ user.createdAt|date('Y-m-d H:i', tz) }}
            </dd>
          </dl>

          <p class="text-secondary small mt-3 mb-0">
            This page is only visible to admins. Use the buttons above to edit or delete this account.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
