<div class="container py-4">

  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h4 m-0">ðŸ“Š Admin dashboard</h1>

    <form method="get" action="{{ path('app_dashboard') }}" class="d-flex align-items-center gap-2">
        <select name="client" class="form-select form-select-sm bg-dark text-light border-secondary"
        onchange="if(this.value===''){window.location.href='{{ path('app_dashboard') }}';}else{this.form.submit();}">
        <option value="" {{ selectedClient is not defined or selectedClient is null ? 'selected':'' }}>All clients</option>
        {% for c in clients %}
          <option value="{{ c.id }}" {{ selectedClient and selectedClient.id == c.id ? 'selected':'' }}>
            {{ c.name }}
          </option>
        {% endfor %}
      </select>
      {% if selectedClient %}
        <a class="btn btn-sm btn-outline-secondary" href="{{ path('app_dashboard') }}">Reset</a>
      {% endif %}
    </form>
  </div>

  <div class="row g-3 mb-4">
    <div class="col-md-4">
      <div class="card bg-dark border-0 p-3 h-100">
        <div class="small text-secondary mb-1">Total time (last 12 months)</div>
        <div class="fs-3">{{ totalMinutes12m|default(0) }} min</div>
        <div class="small text-secondary mt-1">
          Avg: {{ avg.minutes.day }} /day â€¢ {{ avg.minutes.week }} /week â€¢ {{ avg.minutes.month }} /month â€¢ {{ avg.minutes.year }} /year
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card bg-dark border-0 p-3 h-100">
        <div class="small text-secondary mb-1">Total revenue (last 12 months)</div>
        <div class="fs-3">{{ totalRevenue12m|number_format(2, ',', ' ') }} â‚¬</div>
        <div class="small text-secondary mt-1">
          Avg: {{ avg.revenueEuros.day|number_format(2, ',', ' ') }} â‚¬/day â€¢
               {{ avg.revenueEuros.week|number_format(2, ',', ' ') }} â‚¬/week â€¢
               {{ avg.revenueEuros.month|number_format(2, ',', ' ') }} â‚¬/month â€¢
               {{ avg.revenueEuros.year|number_format(2, ',', ' ') }} â‚¬/year
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card bg-dark border-0 p-3 h-100">
        <div class="small text-secondary mb-1">Total thumbnails (last 12 months)</div>
        <div class="fs-3">{{ totalOrders12m|default(0) }}</div>
        <div class="small text-secondary mt-1">
          Avg: {{ avg.orders.day }} /day â€¢ {{ avg.orders.week }} /week â€¢ {{ avg.orders.month }} /month â€¢ {{ avg.orders.year }} /year
        </div>
      </div>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-lg-6">
      <div class="card bg-dark border-secondary mb-3">
        <div class="card-header border-secondary"><span class="fw-semibold">Thumbnails per month</span></div>
        <div class="card-body">{{ render_chart(ordersByMonthChart, {'height': 120}) }}</div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card bg-dark border-secondary mb-3">
        <div class="card-header border-secondary"><span class="fw-semibold">Time spent per month (min)</span></div>
        <div class="card-body">{{ render_chart(timeByMonthChart, {'height': 120}) }}</div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card bg-dark border-secondary mb-3">
        <div class="card-header border-secondary"><span class="fw-semibold">Average time per thumbnail (min)</span></div>
        <div class="card-body">{{ render_chart(avgTimePerOrderChart, {'height': 120}) }}</div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card bg-dark border-secondary mb-3">
        <div class="card-header border-secondary"><span class="fw-semibold">Revenue per month (â‚¬)</span></div>
        <div class="card-body">{{ render_chart(revenueByMonthChart, {'height': 120}) }}</div>
      </div>
    </div>
  </div>

</div>
