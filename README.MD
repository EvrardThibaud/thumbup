
# ThumbUp üé®üìä

ThumbUp est un outil interne pour g√©rer des **commandes de miniatures YouTube** pour des clients (YouTubeurs) :
- Les **admins** g√®rent les clients, les commandes, le temps pass√©, les paiements‚Ä¶
- Les **clients** peuvent cr√©er des commandes, uploader des assets, suivre le statut et r√©cup√©rer leurs miniatures.

> üîó D√©mo en production : https://thumb-up.byevti.com/  
> ‚ö†Ô∏è En prod, **la confirmation d‚Äôemail ne fonctionne pas encore** pour la cr√©ation de compte (les mails ne partent pas).

---

## üß± Stack technique

- **PHP** ‚â• 8.2
- **Symfony** 7+
- **Doctrine ORM**
- **Twig**
- **SQLite** en d√©veloppement
- **MariaDB/MySQL** en production
- Bundles principaux :
  - symfony/security-bundle
  - symfony/ux (Stimulus, Turbo, Autocomplete, Chart.js)
  - doctrine/doctrine-bundle, doctrine/migrations-bundle
  - liip/imagine-bundle (pr√©visualisation des images)
  - vich/uploader-bundle (upload de fichiers)

---

## ‚öôÔ∏è Fonctionnalit√©s principales

- Gestion des **Users** (ROLE_ADMIN / ROLE_CLIENT) et des **Clients**
- Gestion des **Orders** (commandes de miniatures) avec statut (CREATED, ACCEPTED, DOING, DELIVERED, REVISION, FINISHED‚Ä¶)
- Upload d‚Äô**assets client** (OrderAsset) et de **miniatures finales** (Thumbnail)
- Suivi du **temps pass√©** par commande (TimeEntry)
- Suivi basique des **paiements** (Payment)
- Invitations clients via **token** pour cr√©er un compte li√© √† un Client
- Dashboard admin / client (statuts, derni√®res miniatures, etc.)

---

## üöÄ Lancer le projet en d√©veloppement

### 1. Cloner le d√©p√¥t

```bash
git clone https://github.com/EvrardThibaud/thumbup.git thumbup
cd thumbup
````

### 2. Installer les d√©pendances PHP

```bash
composer install
```

En dev, les d√©pendances de debug (profiler, maker, fixtures‚Ä¶) sont install√©es.

### 3. G√©n√©rer le sch√©ma + migrations


```bash
php bin/console doctrine:database:create
php bin/console doctrine:migrations:migrate
```

Avec SQLite, la DB sera cr√©√©e automatiquement dans `var/`.

### 5. Charger les DataFixtures

Les fixtures cr√©ent notamment un compte admin de test.

```bash
php bin/console doctrine:fixtures:load
```

> Identifiants admin cr√©√©s par les fixtures :
>
> * **Email** : `admin@example.com`
> * **Mot de passe** : `adminpass`

### 6. Lancer le serveur de dev

Avec la CLI Symfony (recommand√©) :

```bash
symfony server:start
```

Ou avec PHP natif :

```bash
php -S 127.0.0.1:8000 -t public
```

Le site sera alors accessible sur :
üëâ [http://127.0.0.1:8000](http://127.0.0.1:8000)

---

## üîë Acc√®s & r√¥les

### Compte admin (fixtures)

Utilise ces identifiants en dev :

* Email : `admin@example.com`
* Mot de passe : `adminpass`

L‚Äôadmin peut :

* voir tous les clients et leurs commandes
* cr√©er / √©diter les commandes
* uploader les miniatures finales
* consulter les paiements / time entries
* g√©rer les utilisateurs

---

## üåê Environnement de production

* URL : [https://thumb-up.byevti.com/](https://thumb-up.byevti.com/)
* Base de donn√©es : **MariaDB** (configur√©e via `DATABASE_URL` c√¥t√© Infomaniak)
* PHP : 8.3

Limitations actuelles en prod :

* La cr√©ation de compte fonctionne, mais il est impossible de se connecter car l‚Äôemail ne peut pas √™tre valid√©.
‚Üí Le syst√®me de v√©rification fonctionne en d√©veloppement via Mailtrap, mais pas encore configur√© en production (les emails ne sont pas envoy√©s).

---

## üí≥ Configuration des paiements PayPal (sandbox)

Le projet utilise l‚ÄôAPI **PayPal Orders** en mode **sandbox** pour les paiements.

### 1. Cr√©er / configurer le compte d√©veloppeur

1. Aller sur : [https://developer.paypal.com/tools/sandbox/](https://developer.paypal.com/tools/sandbox/)
2. Se connecter (ou cr√©er un compte PayPal Developer).
3. Cr√©er une **application sandbox** pour obtenir :

   * un **Client ID**
   * un **Client Secret**

Ensuite, mettre ces infos dans `.env.local` :

```env
PAYPAL_MODE=sandbox
PAYPAL_CLIENT_ID="..."
PAYPAL_CLIENT_SECRET="..."
```

### 2. Cr√©er un compte sandbox ‚Äúpayer‚Äù

Important :
Le compte utilis√© dans `PAYPAL_CLIENT_ID` / `PAYPAL_CLIENT_SECRET` correspond au **compte marchand**, c‚Äôest celui qui **re√ßoit** l‚Äôargent.

Pour tester un vrai paiement :

1. Dans la section **Sandbox > Accounts**, cr√©er un **compte personnel sandbox** (un faux utilisateur PayPal).
2. Lors du checkout, se connecter avec **ce** faux compte personnel (payer).
3. Le compte marchand (li√© au Client ID/Secret) ne doit **pas** √™tre le m√™me que celui qui paie.


---

## ‚úâÔ∏è Configuration des emails (validation, reset password, notifications)

Plusieurs fonctionnalit√©s reposent sur l‚Äôenvoi d‚Äôemails :

* **Validation d‚Äôemail** lors de l‚Äôinscription
* **Mot de passe oubli√©** (reset password)
* **Notification admin** quand une nouvelle commande est cr√©√©e

En dev, tout est pens√© pour fonctionner avec **Mailtrap** (sandbox email).

### 1. Cr√©er un compte Mailtrap

1. Aller sur : [https://mailtrap.io](https://mailtrap.io)
2. Cr√©er un compte gratuit.
3. Dans l‚Äôinterface, aller dans la section **Sandbox**.
4. R√©cup√©rer le **DSN Symfony** propos√© (ou les identifiants SMTP).

√áa ressemble √† quelque chose comme :

```env
MAILER_DSN="smtp://<USER>:<PASSWORD>@sandbox.smtp.mailtrap.io:2525"
```

(Coller cette ligne dans ton `.env.local`.)

### 2. R√©sultat

Une fois `MAILER_DSN` configur√© :

* La **validation d‚Äôemail** √† l‚Äôinscription fonctionne en dev (le lien de confirmation arrive dans Mailtrap).
* Le **forgot password** pourra aussi envoyer un lien.
* Les notifications d‚Äôorders fonctionnent : l'admin re√ßoit un email d√®s qu‚Äôun client cr√©e une nouvelle commande.

(Ne fonctionne pas sur le WIFI de l'√©cole !)

---